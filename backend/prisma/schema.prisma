generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  nome      String
  senha     String   // Será salva como Hash (criptografada)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  periodos  Periodo[] // Um usuário tem vários períodos
}

model Periodo {
  id        String   @id @default(uuid())
  codigo    String   // Ex: "2024.1"
  semestre  Int      // Ex: 1, 2, 3...
  
  // 2. RELACIONAMENTO COM USER
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  materias  Materia[]
}

model Materia {
  id               String        @id @default(uuid())
  nome             String
  cor              String?
  professorNome    String?
  professorContato String?
  
  periodoId        String
  periodo          Periodo       @relation(fields: [periodoId], references: [id], onDelete: Cascade)
  
  notas            Nota[]
  atividades       Atividade[]
  horarios         HorarioAula[]
}

model Nota {
  id          String  @id @default(uuid())
  nome        String
  valor       Float?
  notaMaxima Float   
  materiaId   String
  materia     Materia @relation(fields: [materiaId], references: [id], onDelete: Cascade)
}

model Atividade {
  id          String    @id @default(uuid())
  titulo      String
  concluido   Boolean   @default(false)
  dataEntrega DateTime?
  observacao  String?
  tipo        String
  materiaId   String
  materia     Materia   @relation(fields: [materiaId], references: [id], onDelete: Cascade)
}

model HorarioAula {
  id        String  @id @default(uuid())
  diaSemana Int     
  inicio    String  
  fim       String  
  sala      String? 
  materiaId String
  materia   Materia @relation(fields: [materiaId], references: [id], onDelete: Cascade)
}